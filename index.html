<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Railway Traffic Control System - Smart India Hackathon 2025</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">Railway Traffic Control</div>
            <button class="mobile-menu-toggle">‚ò∞</button>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" data-page="home">Home</a></li>
                <li><a href="#" class="nav-link" data-page="dashboard">Dashboard</a></li>
                <li><a href="#" class="nav-link" data-page="map">Live Map</a></li>
                <li><a href="#" class="nav-link" data-page="trains">Trains</a></li>
                <li><a href="#" class="nav-link" data-page="analytics">Analytics</a></li>
                <li><a href="#" class="nav-link" data-page="about">About</a></li>
            </ul>
        </div>
    </nav>

    <div class="main-content">
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="hero">
                <h1>AI-Powered Railway Traffic Control</h1>
                <p>Maximizing Section Throughput Using Intelligent Decision Support System</p>
                <p>Smart India Hackathon 2025 - Ministry of Railways</p>
                <a href="#" class="btn" onclick="showPage('dashboard')">View Dashboard</a>
                <a href="#" class="btn btn-secondary" onclick="showPage('map')">Live Map</a>
            </div>

            <div class="features">
                <div class="feature-card">
                    <h3>üöÇ Real-time Tracking</h3>
                    <p>Monitor all trains across the Indian railway network with live position updates and movement tracking.</p>
                </div>
                <div class="feature-card">
                    <h3>‚ö° AI Optimization</h3>
                    <p>Advanced algorithms for conflict detection, route optimization, and throughput maximization.</p>
                </div>
                <div class="feature-card">
                    <h3>üìä Analytics Dashboard</h3>
                    <p>Comprehensive analytics and reporting for railway operations and performance metrics.</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboard" class="page">
            <div class="page-header">
                <h2>üìä Dashboard</h2>
                <p class="page-description">Real-time overview of railway operations and system performance</p>
            </div>
            
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>üöÇ Active Trains</h3>
                    <div class="metric-value">50</div>
                    <div class="metric-label">Currently Running</div>
                </div>
                <div class="dashboard-card">
                    <h3>üöâ Stations</h3>
                    <div class="metric-value">124</div>
                    <div class="metric-label">Total Stations</div>
                </div>
                <div class="dashboard-card">
                    <h3>üõ§Ô∏è Track Segments</h3>
                    <div class="metric-value">86</div>
                    <div class="metric-label">Active Routes</div>
                </div>
                <div class="dashboard-card">
                    <h3>‚ö° System Status</h3>
                    <div class="metric-value online">Online</div>
                    <div class="metric-label">All Systems Operational</div>
                </div>
            </div>
        </div>

        <!-- Live Map Page -->
        <div id="map" class="page">
            <div class="page-header">
                <h2>üó∫Ô∏è Live Railway Map</h2>
                <p class="page-description">Interactive map showing real-time train positions and railway network across India</p>
            </div>
            
            <!-- Main Map Layout -->
            <div class="map-layout">
                <!-- Left Sidebar -->
                <div class="map-sidebar">
                    <!-- Map Controls -->
                    <div class="sidebar-section">
                        <h4>üéÆ Map Controls</h4>
                        <div class="control-grid">
                            <button onclick="initializeMap()" class="btn btn-primary">üó∫Ô∏è Initialize</button>
                            <button onclick="loadMapData()" class="btn btn-secondary">üìä Load Data</button>
                            <button onclick="refreshMap()" class="btn btn-success">üîÑ Refresh</button>
                            <button onclick="forceUpdateTrains()" class="btn btn-info">üöÇ Update</button>
                        </div>
                    </div>
                    
                    <!-- Display Options -->
                    <div class="sidebar-section">
                        <h4>‚öôÔ∏è Display Options</h4>
                        <div class="control-grid">
                            <button onclick="toggleFullscreen()" class="btn btn-warning">üì∫ Fullscreen</button>
                            <button onclick="toggleVoiceAlerts()" class="btn" id="voice-btn">üîä Voice</button>
                            <button onclick="toggleLiveMovement()" class="btn" id="movement-btn">‚ñ∂Ô∏è Movement</button>
                            <button onclick="showSectionController()" class="btn" id="controller-btn">üéõÔ∏è Controller</button>
                        </div>
                    </div>
                    
                    <!-- Station Monitoring -->
                    <div class="sidebar-section">
                        <h4>üì° Station Monitoring</h4>
                        <div class="station-controls">
                            <select id="station-select" onchange="selectStation()" class="form-select">
                                <option value="">Select station to monitor...</option>
                            </select>
                            <div class="station-buttons">
                                <button onclick="populateStationDropdown()" class="btn btn-secondary">üîÑ Load</button>
                                <button onclick="clearStationFocus()" class="btn btn-outline">Clear</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Status -->
                    <div class="sidebar-section">
                        <h4>üìä System Status</h4>
                        <div id="status-display" class="status-display">Ready</div>
                    </div>
                </div>
                
                <!-- Main Map Area -->
                <div class="map-main">
                    <div id="railway-map" class="railway-map"></div>
                    
                    <!-- AI Message Overlay -->
                    <div id="ai-overlay" class="ai-overlay">
                        <div id="ai-message"></div>
                    </div>
                </div>
                
                <!-- Right Panel -->
                <div class="map-right-panel">
                    <!-- Real-Time Data -->
                    <div class="panel-section">
                        <h4>üìà Real-Time Data</h4>
                        <div id="real-time-data" class="real-time-data">
                            <div class="data-item">
                                <span class="data-label">Active Trains:</span>
                                <span id="active-trains-count" class="data-value">0</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Total Stations:</span>
                                <span id="total-stations-count" class="data-value">0</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Track Segments:</span>
                                <span id="track-segments-count" class="data-value">0</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">System Status:</span>
                                <span id="system-status" class="data-value">Online</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Live Station Monitoring Panel -->
            <div id="live-station-monitor" class="live-station-monitor" style="display: none;">
                <div class="monitor-header">
                    <h4>üì° Live Station Monitoring</h4>
                    <button onclick="closeLiveMonitor()" class="btn btn-secondary">‚úï Close</button>
                </div>
                <div class="monitor-content">
                    <div class="station-info">
                        <h5 id="monitor-station-name">Station Name</h5>
                        <div class="station-stats">
                            <div class="stat-item">
                                <span class="stat-label">Connected Tracks:</span>
                                <span id="monitor-tracks-count" class="stat-value">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Active Trains:</span>
                                <span id="monitor-trains-count" class="stat-value">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Monitoring Status:</span>
                                <span id="monitor-status" class="stat-value">Active</span>
                            </div>
                        </div>
                    </div>
                    <div class="live-trains-list">
                        <h6>üöÇ Live Train Movements</h6>
                        <div id="live-trains-container" class="trains-container">
                            <div class="loading">Loading live train data...</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI Controller Panel -->
            <div id="ai-controller-panel" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 2px solid #dc2626; border-radius: 10px; padding: 20px; z-index: 2000; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="margin: 0; color: #dc2626;">üéõÔ∏è AI Section Controller</h3>
                    <button onclick="hideAIControllerPanel()" style="background: #dc2626; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer;">√ó</button>
                </div>
                <div id="ai-controller-content"></div>
            </div>
        </div>

        <!-- Trains Page -->
        <div id="trains" class="page">
            <div class="page-header">
                <h2>üöÇ Train Management</h2>
                <p class="page-description">Monitor and manage all active trains across the railway network</p>
            </div>
            
            <div class="trains-grid">
                <div class="loading">Loading train data...</div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics" class="page">
            <div class="page-header">
                <h2>üìä Analytics</h2>
                <p class="page-description">Comprehensive analytics and performance metrics</p>
            </div>
            
            <div class="analytics-grid">
                <div class="loading">Loading analytics data...</div>
            </div>
        </div>

        <!-- About Page -->
        <div id="about" class="page">
            <div class="page-header">
                <h2>‚ÑπÔ∏è About</h2>
                <p class="page-description">Learn more about the Railway Traffic Control System</p>
            </div>
            
            <div class="about-content">
                <div class="about-card">
                    <h3>üéØ Mission</h3>
                    <p>To revolutionize railway traffic control through AI-powered decision support systems that maximize throughput while ensuring safety and efficiency.</p>
                </div>
                <div class="about-card">
                    <h3>üöÄ Technology</h3>
                    <p>Built with cutting-edge technologies including machine learning, real-time data processing, and advanced optimization algorithms.</p>
                </div>
                <div class="about-card">
                    <h3>üèÜ Smart India Hackathon 2025</h3>
                    <p>Developed for the Ministry of Railways as part of the Smart India Hackathon 2025 initiative.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Railway Traffic Control System. Smart India Hackathon 2025 - Ministry of Railways</p>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Global variables
        let map;
        let mapData = null;
        let trainMarkers = [];
        let stationMarkers = [];
        let trackLines = [];
        let isFullscreen = false;
        let voiceAlertsEnabled = false;
        let liveMovementEnabled = true;
        let realTimeUpdateInterval;
        let selectedStation = null;
        let liveStationMonitorInterval;

        // Navigation functionality
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // Initialize map if on map page
            if (pageId === 'map') {
                setTimeout(() => {
                    initializeMap();
                    loadMapData();
                }, 100);
            }
        }

        // Map initialization
        function initializeMap() {
            try {
                console.log('üó∫Ô∏è Initializing map...');
                
                if (map) {
                    map.remove();
                }
                
                // Create new map with stable settings - centered on India
                map = L.map('railway-map', {
                    zoomControl: true,
                    scrollWheelZoom: true,
                    doubleClickZoom: true,
                    boxZoom: true,
                    keyboard: true,
                    dragging: true,
                    touchZoom: true,
                    zoomSnap: 0.25,
                    zoomDelta: 0.5,
                    wheelPxPerZoomLevel: 120
                }).setView([20.5937, 78.9629], 6); // Centered on India with zoom level 6
                
                // Add tile layer
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors',
                    maxZoom: 18,
                    minZoom: 4,
                    opacity: 0.9
                }).addTo(map);
                
                // Prevent map resize issues
                map.on('resize', () => {
                    setTimeout(() => map.invalidateSize(), 100);
                });
                
                // Initial size validation
                setTimeout(() => {
                    map.invalidateSize();
                }, 100);
                
                // Debug: Check if map is visible
                setTimeout(() => {
                    if (map) {
                        console.log('üó∫Ô∏è Map is ready and visible');
                        console.log('üìç Map center:', map.getCenter());
                        console.log('üîç Map zoom:', map.getZoom());
                        
                        // Force map to be visible
                        map.invalidateSize();
                        
                        // Auto-load data after map is ready
                        loadMapData();
                    } else {
                        console.error('‚ùå Map failed to initialize');
                        updateStatus('‚ùå Map failed to initialize');
                    }
                }, 1000);
                
                updateStatus('‚úÖ Map initialized successfully');
                
            } catch (error) {
                console.error('‚ùå Map initialization error:', error);
                updateStatus('‚ùå Map initialization failed: ' + error.message);
            }
        }

        // Load map data
        function loadMapData() {
            console.log('üìä Loading map data...');
            updateStatus('üìä Loading map data...');
            
            fetch('http://localhost:8081/api/map-data')
                .then(response => response.json())
                .then(data => {
                    console.log('‚úÖ Map data loaded:', data);
                    mapData = data;
                    
                    // Add elements to map
                    addStationsToMap();
                    addTracksToMap();
                    addTrainsToMap();
                    
                    // Update real-time data display
                    updateRealTimeDataDisplay();
                    
                    // Start real-time updates
                    startRealTimeUpdates();
                    
                    // Populate station dropdown
                    populateStationDropdown();
                    
                    updateStatus('‚úÖ Map data loaded successfully');
                })
                .catch(error => {
                    console.error('‚ùå Error loading map data:', error);
                    updateStatus('‚ùå Failed to load map data: ' + error.message);
                });
        }

        // Add stations to map
        function addStationsToMap() {
            if (!mapData || !mapData.stations) return;
            
            console.log('üöâ Adding stations to map...');
            
            mapData.stations.forEach(station => {
                const stationMarker = L.marker([station.latitude, station.longitude], {
                    icon: L.divIcon({
                        className: 'station-marker',
                        html: 'üöâ',
                        iconSize: [20, 20],
                        iconAnchor: [10, 10]
                    })
                }).addTo(map);
                
                stationMarker.bindPopup(`
                    <div class="station-popup">
                        <h4>${station.name}</h4>
                        <p><strong>Code:</strong> ${station.code}</p>
                        <p><strong>State:</strong> ${station.state}</p>
                        <p><strong>Zone:</strong> ${station.zone}</p>
                    </div>
                `);
                
                stationMarkers.push(stationMarker);
            });
            
            console.log(`‚úÖ Added ${mapData.stations.length} stations to map`);
        }

        // Add tracks to map
        function addTracksToMap() {
            if (!mapData || !mapData.tracks) return;
            
            console.log('üõ§Ô∏è Adding tracks to map...');
            
            mapData.tracks.forEach(track => {
                const fromStation = mapData.stations.find(s => s.id === track.from_station);
                const toStation = mapData.stations.find(s => s.id === track.to_station);
                
                if (fromStation && toStation) {
                    const trackLine = L.polyline([
                        [fromStation.latitude, fromStation.longitude],
                        [toStation.latitude, toStation.longitude]
                    ], {
                        color: '#1e40af',
                        weight: 3,
                        opacity: 0.7,
                        dashArray: '5, 5'
                    }).addTo(map);
                    
                    trackLine.bindPopup(`
                        <div class="track-popup">
                            <h4>Track ${track.id}</h4>
                            <p><strong>From:</strong> ${fromStation.name}</p>
                            <p><strong>To:</strong> ${toStation.name}</p>
                            <p><strong>Length:</strong> ${track.length} km</p>
                        </div>
                    `);
                    
                    trackLines.push(trackLine);
                }
            });
            
            console.log(`‚úÖ Added ${mapData.tracks.length} tracks to map`);
        }

        // Add trains to map
        function addTrainsToMap() {
            if (!mapData || !mapData.trains) return;
            
            console.log('üöÇ Adding trains to map...');
            
            mapData.trains.forEach(train => {
                const trainMarker = L.marker([train.position.latitude, train.position.longitude], {
                    icon: L.divIcon({
                        className: 'train-marker',
                        html: getTrainIcon(train),
                        iconSize: [24, 24],
                        iconAnchor: [12, 12]
                    })
                }).addTo(map);
                
                trainMarker.bindPopup(`
                    <div class="train-popup">
                        <h4>${train.train_number} - ${train.train_name}</h4>
                        <p><strong>Speed:</strong> ${train.speed} km/h</p>
                        <p><strong>Progress:</strong> ${train.progress}%</p>
                        <p><strong>Status:</strong> ${train.status}</p>
                        <p><strong>Route:</strong> ${train.origin} ‚Üí ${train.destination}</p>
                    </div>
                `);
                
                trainMarker.trainNumber = train.train_number;
                trainMarkers.push(trainMarker);
            });
            
            console.log(`‚úÖ Added ${mapData.trains.length} trains to map`);
        }

        // Get train icon
        function getTrainIcon(train) {
            return `<span style="font-size: 18px; color: #1e40af; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">üöÇ</span>`;
        }

        // Update train positions
        function updateTrainPositions() {
            if (!mapData || !mapData.trains) return;
            
            mapData.trains.forEach(train => {
                const marker = trainMarkers.find(m => m.trainNumber === train.train_number);
                if (marker) {
                    marker.setLatLng([train.position.latitude, train.position.longitude]);
                }
            });
        }

        // Start real-time updates
        function startRealTimeUpdates() {
            if (realTimeUpdateInterval) {
                clearInterval(realTimeUpdateInterval);
            }
            
            realTimeUpdateInterval = setInterval(() => {
                updateTrainPositions();
                updateRealTimeDataDisplay();
            }, 2000);
        }

        // Update real-time data display
        function updateRealTimeDataDisplay() {
            if (!mapData) return;
            
            document.getElementById('active-trains-count').textContent = mapData.trains.length;
            document.getElementById('total-stations-count').textContent = mapData.stations.length;
            document.getElementById('track-segments-count').textContent = mapData.tracks.length;
            document.getElementById('system-status').textContent = 'Online';
        }

        // Station selection
        function selectStation() {
            const select = document.getElementById('station-select');
            const stationId = select.value;
            
            if (stationId) {
                const station = mapData.stations.find(s => s.id === stationId);
                if (station) {
                    selectedStation = station;
                    map.setView([station.latitude, station.longitude], 12, { animate: false });
                    startLiveStationMonitoring(station);
                }
            } else {
                clearStationFocus();
            }
        }

        // Start live station monitoring
        function startLiveStationMonitoring(station) {
            document.getElementById('live-station-monitor').style.display = 'block';
            document.getElementById('monitor-station-name').textContent = station.name;
            
            updateLiveStationData(station);
            
            if (liveStationMonitorInterval) {
                clearInterval(liveStationMonitorInterval);
            }
            
            liveStationMonitorInterval = setInterval(() => {
                updateLiveStationData(station);
            }, 3000);
        }

        // Update live station data
        function updateLiveStationData(station) {
            if (!mapData) return;
            
            // Find trains at or approaching this station
            const trainsAtStation = mapData.trains.filter(train => 
                train.current_station === station.id ||
                train.next_station === station.id ||
                train.origin === station.id ||
                train.destination === station.id
            );
            
            // Find connected tracks
            const connectedTracks = mapData.tracks.filter(track => 
                track.from_station === station.id || track.to_station === station.id
            );
            
            // Update display
            document.getElementById('monitor-tracks-count').textContent = connectedTracks.length;
            document.getElementById('monitor-trains-count').textContent = trainsAtStation.length;
            document.getElementById('monitor-status').textContent = 'Active';
            
            // Update trains list
            updateLiveTrainsList(trainsAtStation, connectedTracks);
        }

        // Update live trains list
        function updateLiveTrainsList(trains, tracks) {
            const container = document.getElementById('live-trains-container');
            
            if (trains.length === 0) {
                container.innerHTML = '<div class="no-trains">No trains at this station</div>';
                return;
            }
            
            container.innerHTML = trains.map(train => `
                <div class="train-item">
                    <div class="train-header">
                        <span class="train-number">${train.train_number}</span>
                        <span class="train-name">${train.train_name}</span>
                        <span class="train-status ${train.status.toLowerCase()}">${train.status}</span>
                    </div>
                    <div class="train-details">
                        <div class="train-route">
                            <span class="route-from">${train.origin}</span>
                            <span class="route-arrow">‚Üí</span>
                            <span class="route-to">${train.destination}</span>
                        </div>
                        <div class="train-location">
                            <span class="location-text">Current: ${train.current_station}</span>
                        </div>
                        <div class="train-metrics">
                            <div class="metric">Speed: ${train.speed} km/h</div>
                            <div class="metric">Progress: ${train.progress}%</div>
                            <div class="metric">Delay: ${train.delay || 0} min</div>
                        </div>
                        ${train.collision_risk ? '<span class="alert-badge collision">‚ö†Ô∏è Collision Risk</span>' : ''}
                        ${train.rerouting_needed ? '<span class="alert-badge rerouting">üîÑ Rerouting Needed</span>' : ''}
                    </div>
                </div>
            `).join('');
        }

        // Close live monitor
        function closeLiveMonitor() {
            document.getElementById('live-station-monitor').style.display = 'none';
            if (liveStationMonitorInterval) {
                clearInterval(liveStationMonitorInterval);
            }
        }

        // Clear station focus
        function clearStationFocus() {
            selectedStation = null;
            document.getElementById('station-select').value = '';
            closeLiveMonitor();
        }

        // Populate station dropdown
        function populateStationDropdown() {
            const select = document.getElementById('station-select');
            select.innerHTML = '<option value="">Select station to monitor...</option>';
            
            if (mapData && mapData.stations) {
                mapData.stations.forEach(station => {
                    const option = document.createElement('option');
                    option.value = station.id;
                    option.textContent = `${station.name} (${station.code})`;
                    select.appendChild(option);
                });
            }
        }

        // Toggle functions
        function toggleFullscreen() {
            if (!isFullscreen) {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                }
                isFullscreen = true;
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
                isFullscreen = false;
            }
        }

        function toggleVoiceAlerts() {
            voiceAlertsEnabled = !voiceAlertsEnabled;
            const btn = document.getElementById('voice-btn');
            btn.textContent = voiceAlertsEnabled ? 'üîä Voice ON' : 'üîä Voice';
            btn.style.backgroundColor = voiceAlertsEnabled ? '#059669' : '';
        }

        function toggleLiveMovement() {
            liveMovementEnabled = !liveMovementEnabled;
            const btn = document.getElementById('movement-btn');
            btn.textContent = liveMovementEnabled ? '‚è∏Ô∏è Pause' : '‚ñ∂Ô∏è Movement';
            btn.style.backgroundColor = liveMovementEnabled ? '#059669' : '';
        }

        function showSectionController() {
            document.getElementById('ai-controller-panel').style.display = 'block';
        }

        function hideAIControllerPanel() {
            document.getElementById('ai-controller-panel').style.display = 'none';
        }

        // Utility functions
        function refreshMap() {
            if (map) {
                map.invalidateSize();
                updateStatus('üîÑ Map refreshed');
            }
        }

        function forceUpdateTrains() {
            loadMapData();
            updateStatus('üöÇ Train data updated');
        }

        function updateStatus(message) {
            document.getElementById('status-display').textContent = message;
            console.log('üìä Status:', message);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Railway Traffic Control System initialized');
            
            // Set up navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    showPage(pageId);
                });
            });
            
            // Mobile menu toggle
            document.querySelector('.mobile-menu-toggle').addEventListener('click', function() {
                document.querySelector('.nav-links').classList.toggle('active');
            });
            
            // Auto-populate station dropdown
            setTimeout(() => {
                populateStationDropdown();
            }, 1000);
        });
    </script>
</body>
</html>
